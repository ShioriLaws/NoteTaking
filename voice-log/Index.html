<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>éŸ³å£°æ”¯å‡ºå…¥åŠ›</title>
</head>
<body>
  <h1>ğŸ™ï¸ æ”¯å‡ºã‚’éŸ³å£°ã§è¨˜éŒ²</h1>
  <button id="start-button">ğŸ¤ è©±ã™</button>
  <p id="transcript"></p>
  <script>
    const button = document.getElementById('start-button');
    const transcript = document.getElementById('transcript');

    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = 'ja-JP';
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    button.onclick = () => {
      recognition.start();
      transcript.textContent = 'ğŸ§ èãå–ã‚Šä¸­...';
    };

    recognition.onresult = (event) => {
      const speech = event.results[0][0].transcript;
      transcript.textContent = `âœ… å…¥åŠ›: ${speech}`;

      // æŸ”è»Ÿã«ç”¨é€”ã¨é‡‘é¡ã‚’æ¤œå‡ºï¼ˆä¾‹: "ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°49352 9.72ãƒ‰ãƒ«" ã¾ãŸã¯ "ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚° 9.36ãƒ‰ãƒ«"ï¼‰
      const regex = /(.+?)\s*([0-9]+(?:\.[0-9]+)?)\s*ãƒ‰ãƒ«?/;
      const match = speech.match(regex);

      if (match) {
        const category = match[1].trim();
        const amount = match[2];

        const today = new Date();
        const year = today.getFullYear();
        const month = String(today.getMonth() + 1).padStart(2, '0');
        const day = String(today.getDate()).padStart(2, '0');
        const date = `${year}/${month}/${day}`;

        fetch('https://script.google.com/macros/s/AKfycbwaKEMBnFE5PrL4HXvKIIQrUFUo6kTRWKe7jha3dz2C8K5fDOvjYAJQ6XnVDfA0e5qi/exec', {
          method: 'POST',
          mode: 'no-cors',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ date, category, amount })
        });

        transcript.textContent += `\nğŸ“¤ é€ä¿¡ã—ã¾ã—ãŸï¼š${date} - ${category} - ${amount}ãƒ‰ãƒ«`;
      } else {
        transcript.textContent += '\nâš ï¸ èªè­˜å¤±æ•—ã¾ãŸã¯å½¢å¼ãŒä¸æ˜ã§ã™ã€‚ä¾‹ï¼š"ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°49352 9.72ãƒ‰ãƒ«" ã¾ãŸã¯ "ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚° 9.36ãƒ‰ãƒ«"';
      }
    };
  </script>
</body>
</html>
